(()=>{"use strict";const e=.5*window.innerWidth,t=.8*window.innerHeight;function o(e=10){let t="";const o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=o.length;let c=0;for(;c<e;)t+=o.charAt(Math.floor(Math.random()*n)),c+=1;return t}function n(e){return Math.floor(Math.random()*e)}const c=document.getElementById("hovered-color"),l=document.getElementById("selected-color"),r=(document.getElementById("random-color"),document.getElementById("file-input")),d=document.getElementById("canvas-wrapper"),a=document.getElementById("add-color-button"),i=document.getElementById("add-random-color");let m=[];function s(e,t,n){const c=document.createElement("div"),l=document.createElement("div");l.className="color-preview random-color";const r=o();l.id=r,document.getElementById("random-color-wrapper").appendChild(l),c.className="color-pin",c.style.left=e-9+"px",c.style.top=t-9+"px",c.id="pin_"+r;const d=g(null,l,{x:e,y:t},n);m.push({id:r,color:d}),l.background=d,c.style.background=d,document.getElementById("canvas-wrapper").appendChild(c)}function u(e){const t=e.target.id;document.getElementById(t).remove(),document.getElementById("pin_"+t)?.remove(),m=m.filter((e=>e.id!==t))}function g(e,t,o,n){const c=canvas.getBoundingClientRect();let l,r;o?(l=o.x,r=o.y):(l=e.clientX-c.left,r=e.clientY-c.top);const d=n.getImageData(l,r,1,1).data,a=`rgba(${d[0]}, ${d[1]}, ${d[2]}, ${d[3]/255})`;return t.style.background=a,document.getElementById(`${t.id}-value`)&&(document.getElementById(`${t.id}-value`).textContent=a),a}a&&a.addEventListener("click",(e=>{e.target.dataset.color&&function(e){if(m[m.length-1]!==e){const t=document.createElement("div");t.className="color-preview random-color";const n=o();t.id=n,t.style.background=e,document.getElementById("random-color-wrapper").appendChild(t),m.push({id:n,color:e}),document.querySelectorAll(".color-preview").forEach((e=>{e.removeEventListener("click",u)})),document.querySelectorAll(".color-preview").forEach((e=>{e.addEventListener("click",u)}))}}(e.target.dataset.color)})),r.onchange=o=>{const[m]=r.files;m&&(document.querySelectorAll(".random-color").forEach((e=>{e.remove()})),document.querySelectorAll(".color-pin").forEach((e=>{e.remove()})),function(o){const r=new Image;r.crossOrigin="anonymous",r.src=URL.createObjectURL(o);const m=document.getElementById("canvas"),h=m.getContext("2d");r.addEventListener("load",(function(){const[o,y]=function(o,n){return o>n?o>e&&(n*=e/o,o=e):n>t&&(o*=t/n,n=t),[o,n]}(this.width,this.height);m.width=o,m.height=y,d.style.width=o,d.style.height=y,h.drawImage(this,0,0,o,y);const E=document.getElementById("pixelated-zoom").getContext("2d");E.imageSmoothingEnabled=!1,E.mozImageSmoothingEnabled=!1,E.webkitImageSmoothingEnabled=!1,E.msImageSmoothingEnabled=!1;r.style.display="none",m.addEventListener("mousemove",(e=>{g(e,c,null,h);const t=e.layerX,o=e.layerY;((e,t,o)=>{e.drawImage(m,Math.min(Math.max(0,t-5),r.width-9),Math.min(Math.max(0,o-5),r.height-9),9,9,0,0,200,200)})(E,t,o)})),m.addEventListener("click",(e=>{const t=g(e,l,null,h);a.dataset.color=t,a.style.display="inline-block"})),i.addEventListener("click",(()=>{s(n(o),n(y),h),document.querySelectorAll(".color-preview").forEach((e=>{e.removeEventListener("click",u)})),document.querySelectorAll(".color-preview").forEach((e=>{e.addEventListener("click",u)}))})),function(e,t,o){for(let c=0;c<10;c++)s(n(e),n(t),o);document.querySelectorAll(".color-preview").forEach((e=>{e.removeEventListener("click",u)})),document.querySelectorAll(".color-preview").forEach((e=>{e.addEventListener("click",u)}))}(o,y,h)}))}(m),document.querySelectorAll(".color-wrapper").forEach((e=>{e.style.display="flex"})),i.style.display="inline-block")}})();