(()=>{"use strict";const e=.5*window.innerWidth,t=.8*window.innerHeight;function o(e=10){let t="";const o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=o.length;let l=0;for(;l<e;)t+=o.charAt(Math.floor(Math.random()*n)),l+=1;return t}function n(e){return Math.floor(Math.random()*e)}const l=document.getElementById("hovered-color"),c=document.getElementById("selected-color"),r=(document.getElementById("random-color"),document.getElementById("file-input")),d=document.getElementById("canvas-wrapper"),a=document.getElementById("add-color-button"),i=document.getElementById("add-random-color");let m=[];function s(e,t,n){const l=document.createElement("div"),c=document.createElement("div");c.className="color-preview random-color";const r=o();c.id=r,document.getElementById("random-color-wrapper").appendChild(c),l.className="color-pin",l.style.left=e-9+"px",l.style.top=t-9+"px",l.id="pin_"+r;const d=g(null,c,{x:e,y:t},n);m.push({id:r,color:d}),c.background=d,l.style.background=d,document.getElementById("canvas-wrapper").appendChild(l)}function u(e){const t=e.target.id;document.getElementById(t).remove(),document.getElementById("pin_"+t)?.remove(),m=m.filter((e=>e.id!==t))}function g(e,t,o,n){const l=canvas.getBoundingClientRect();let c,r;o?(c=o.x,r=o.y):(c=e.clientX-l.left,r=e.clientY-l.top);const d=n.getImageData(c,r,1,1).data,a=`rgba(${d[0]}, ${d[1]}, ${d[2]}, ${d[3]/255})`;return t.style.background=a,document.getElementById(`${t.id}-value`)&&(document.getElementById(`${t.id}-value`).textContent=a),a}a&&a.addEventListener("click",(e=>{e.target.dataset.color&&function(e){if(m[m.length-1]!==e){const t=document.createElement("div");t.className="color-preview random-color";const n=o();t.id=n,t.style.background=e,document.getElementById("random-color-wrapper").appendChild(t),m.push({id:n,color:e}),document.querySelectorAll(".color-preview").forEach((e=>{e.removeEventListener("click",u)})),document.querySelectorAll(".color-preview").forEach((e=>{e.addEventListener("click",u)}))}}(e.target.dataset.color)})),r.onchange=o=>{const[m]=r.files;m&&(document.querySelectorAll(".random-color").forEach((e=>{e.remove()})),document.querySelectorAll(".color-pin").forEach((e=>{e.remove()})),function(o){const r=new Image;r.crossOrigin="anonymous",r.src=URL.createObjectURL(o);const m=document.getElementById("canvas"),y=m.getContext("2d");r.addEventListener("load",(function(){const[o,p]=function(o,n){return o>n?o>e&&(n*=e/o,o=e):n>t&&(o*=t/n,n=t),[o,n]}(this.width,this.height);m.width=o,m.height=p,d.style.width=o,d.style.height=p,y.drawImage(this,0,0,o,p);const E=document.getElementById("pixelated-zoom").getContext("2d");E.imageSmoothingEnabled=!1,E.mozImageSmoothingEnabled=!1,E.webkitImageSmoothingEnabled=!1,E.msImageSmoothingEnabled=!1;r.style.display="none",m.addEventListener("mousemove",(e=>{g(e,l,null,y),console.log(e);const t=document.getElementById("magnifier-wrapper");t.style.left=e.layerX+1+"px",t.style.top=e.layerY+1+"px",t.style.display="block";const o=e.layerX,n=e.layerY;((e,t,o)=>{e.drawImage(m,t-2,o-2,5,5,0,0,100,100)})(E,o,n)})),m.addEventListener("click",(e=>{const t=g(e,c,null,y);a.dataset.color=t,a.style.display="inline-block"})),i.addEventListener("click",(()=>{s(n(o),n(p),y),document.querySelectorAll(".color-preview").forEach((e=>{e.removeEventListener("click",u)})),document.querySelectorAll(".color-preview").forEach((e=>{e.addEventListener("click",u)}))})),function(e,t,o){for(let l=0;l<10;l++)s(n(e),n(t),o);document.querySelectorAll(".color-preview").forEach((e=>{e.removeEventListener("click",u)})),document.querySelectorAll(".color-preview").forEach((e=>{e.addEventListener("click",u)}))}(o,p,y)}))}(m),document.querySelectorAll(".color-wrapper").forEach((e=>{e.style.display="flex"})),i.style.display="inline-block")}})();