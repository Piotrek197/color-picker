(()=>{"use strict";const e=.9*window.innerWidth*.5,t=.8*window.innerHeight;function o(e=10){let t="";const o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=o.length;let l=0;for(;l<e;)t+=o.charAt(Math.floor(Math.random()*n)),l+=1;return t}function n(e){return Math.floor(Math.random()*e)}const l=document.getElementById("hovered-color"),c=document.getElementById("selected-color"),r=(document.getElementById("random-color"),document.getElementById("file-input")),d=document.getElementById("canvas-wrapper"),a=document.getElementById("add-color-button"),i=document.getElementById("add-random-color");let m=[];function s(e){const t=e.target.id;document.getElementById(t).remove(),document.getElementById("pin_"+t)?.remove(),m=m.filter((e=>e.id!==t))}function u(e,t,o,n){const l=canvas.getBoundingClientRect();let c,r;o?(c=o.x,r=o.y):(c=e.clientX-l.left,r=e.clientY-l.top);const d=n.getImageData(c,r,1,1).data,a=`rgba(${d[0]}, ${d[1]}, ${d[2]}, ${d[3]/255})`;return t.style.background=a,document.getElementById(`${t.id}-value`)&&(document.getElementById(`${t.id}-value`).value=a),a}a&&a.addEventListener("click",(e=>{e.target.dataset.color&&function(e){if(m[m.length-1]!==e){const t=document.createElement("div");t.className="color-preview random-color";const n=o();t.id=n,t.style.background=e,document.getElementById("random-color-wrapper").appendChild(t),m.push({id:n,color:e}),document.querySelectorAll(".color-preview").forEach((e=>{e.removeEventListener("click",s)})),document.querySelectorAll(".color-preview").forEach((e=>{e.addEventListener("click",s)}))}}(e.target.dataset.color)})),r.onchange=g=>{const[y]=r.files;y&&(document.querySelectorAll(".random-color").forEach((e=>{e.remove()})),document.querySelectorAll(".color-pin").forEach((e=>{e.remove()})),function(r){const g=new Image;g.crossOrigin="anonymous",g.src=URL.createObjectURL(r);const y=document.getElementById("canvas"),p=y.getContext("2d");console.log("ctx",p),g.addEventListener("load",(function(){const[r,E]=function(o,n){return o>n?o>e&&(n*=e/o,o=e):n>t&&(o*=t/n,n=t),[o,n]}(this.width,this.height);document.getElementById("file-input-label").remove(),y.width=r,y.height=E,d.style.width=r,d.style.height=E,p.drawImage(this,0,0,r,E);const h=document.getElementById("pixelated-zoom").getContext("2d");h.imageSmoothingEnabled=!1,h.mozImageSmoothingEnabled=!1,h.webkitImageSmoothingEnabled=!1,h.msImageSmoothingEnabled=!1;g.style.display="none",console.log("image",this),y.addEventListener("mousemove",(e=>{u(e,l,null,p),console.log(e);const t=document.getElementById("preview-cursor");t.style.left=e.layerX+1+"px",t.style.top=e.layerY+1+"px",t.style.display="block";const o=e.layerX,n=e.layerY;((e,t,o)=>{e.drawImage(y,t-2,o-2,5,5,0,0,100,100)})(h,o,n)})),y.addEventListener("click",(e=>{console.log("color picked",e,c);const t=u(e,c,null,p);a.dataset.color=t,a.style.display="inline-block"})),i.addEventListener("click",(()=>{(function(e,t,n){const l=document.createElement("div"),c=document.createElement("div");c.className="color-preview random-color";const r=o();c.id=r,document.getElementById("random-color-wrapper").appendChild(c),l.className="color-pin",l.style.left=e-9+"px",l.style.top=t-9+"px",l.id="pin_"+r;const d=u(null,c,{x:e,y:t},n);m.push({id:r,color:d}),c.background=d,l.style.background=d,document.getElementById("canvas-wrapper").appendChild(l)})(n(r),n(E),p),document.querySelectorAll(".color-preview").forEach((e=>{e.removeEventListener("click",s)})),document.querySelectorAll(".color-preview").forEach((e=>{e.addEventListener("click",s)}))}))}))}(y),document.querySelectorAll(".color-wrapper").forEach((e=>{e.style.display="inline-flex"})),i.style.display="inline-block")}})();